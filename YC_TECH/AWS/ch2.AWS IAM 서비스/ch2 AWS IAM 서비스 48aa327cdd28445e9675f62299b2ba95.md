# ch2. AWS IAM 서비스

### 1. IAM이란?

- Identity(사용자 신원 증명) & Access Management(접근 권한 관리)
- 사용자 및 그룹 생성하고 세부적인 접근 권한 제어를 위한 서비스(for 보안)
- 보안 강화를 위한 추가 인증 제공
- AWS 서비스 간의 역할 및 권한 제어

### 2. IAM 사용자와 정책

- 루트 사용자(Root User)
    - AWS 회원 가입 시 생성되는 계정
    - AWS 서비스에 대한 모든 권한 보유
    - 권장사항: 루트 사용자 계정은 사용X/ 아이디와 패스워드도 절대 공유X
- 사용자(User)
    - 루트 사용자 계정은 다수의 사용자 생성 가능
    - 사용자마다 서로 다른 권한 보유 가능
    - AWS의 모든 리소스는 사용자 계정으로 접근
- 정책(Policy)
    - 권한 정보가 작성된 문서
    - 어떤 서비스에 대해 어떤 행위가 가능한지 작성
    - 사용자 생성 시 특정 정책을 연결(정책에 작성 된 권한 정보가 사용자에게 부여됨)

![스크린샷 2023-10-24 오후 3.50.47.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.50.47.png)

- [Action] 특정서비스:특정동작
- [Effect] Allow하거나 Deny함
- [Resource] 구체적인 AWS 리소스에 적용

### 3-1. 사용자가 AWS에 접근하는 방식

- 관리 콘솔(Management Console)
    
    ![스크린샷 2023-10-24 오후 3.56.38.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.56.38.png)
    
    - 사용자 인증 방식: ID/PW 및 MFA
- CLI(Command Line Interface)
    - 명령형 인터페이스로 AWS 서비스 관리
    - 클라이언트에 aws-cli 설치한 후 CLI인터페이스 활용
    - 예시) EC2 인스턴스를 조회하는 명령어
        
        ```java
        $ aws ec2 describe-instances
        ```
        
    - 사용자 인증 방식: Access Key ID와 Secret Access Key
- SDK(SW Development Kit)
    - 프로그래밍 언어를 통해 AWS 리소스에 접근하는 방식
    - Application 내부(백엔드 코드)에서 AWS 리소스 생성, 수정
    - 사용자 인증 방식: Access Key ID와 Secret Access Key

### 3-2. CLI와 SDK의 사용자 인증 방식

![스크린샷 2023-10-24 오후 4.01.06.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.01.06.png)

- Access Key ID와 Secret Access Key
- 사용자 단위로 부여
- Access Key ID: username의 개념
- Secret Access Key: password의 개념

### 4. 사용자 생성 실습

1) 사용자 생성

![스크린샷 2023-10-24 오후 4.07.14.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.07.14.png)

2) 콘솔 로그인 Url로 들어가기

![스크린샷 2023-10-24 오후 4.09.14.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.09.14.png)

3) IAM 사용자로 로그인 확인

![스크린샷 2023-10-24 오후 4.12.08.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.12.08.png)

4) 허가 받은 서비스와 그렇지 않은 서비스 접근

- 허가받은 서비스:EC2

![스크린샷 2023-10-24 오후 4.16.37.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.16.37.png)

- 허가받지 않은 서비스: IAM

![스크린샷 2023-10-24 오후 4.13.09.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.13.09.png)

### 5. IAM 그룹(Group)

![스크린샷 2023-10-24 오후 4.20.44.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.20.44.png)

- 그룹은 사용자들의 집합으로 정책에 의한 권한 갖음
- 다수의 사용자 **⊂** 하나의 그룹
- 사용자는 본인 소속 그룹의 권한 부여받음(최대 10개의 그룹에 소속 가능)
- 즉, 사용자의 권한: 사용자 자체 권한+ 소속된 그룹의 권한

1) 사용자 그룹 생성

![스크린샷 2023-10-24 오후 4.25.08.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.25.08.png)

2) 사용자 권한 범위 확인

![스크린샷 2023-10-24 오후 4.25.39.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.25.39.png)

![스크린샷 2023-10-24 오후 4.26.03.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-24_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.26.03.png)

### 6. IAM 역할(Role)

- 특정한 권한을 갖고 있는 IAM Entity(사용자, 그룹 등) 중 하나
- 특정 권한이 필요한 사용자, AWS 서비스 등에 임시로 역할 위임 가능
    - AWS 서비스에 역할을 부여한 예: EC2 인스턴스에서 S3에 접근
    - 부여 받은 역할은 특정시간동안만 유효
- 외부 자격 공급자에게도 역할 부여 가능
    - Facebook, Google, Amazon 계정, SAML 2.0기반 계정 등

![스크린샷 2023-10-26 오전 11.42.33.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.42.33.png)

![스크린샷 2023-10-26 오전 11.42.43.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.42.43.png)

### 7. MFA(Multi Factor Authentication)

- Management Console 로그인 ID/PW 유실 가능성 대비
- 보안을 강화하기 위한 추가적인 인증 작업
    - 가상 MFA 기기: Google Authenticator, Microsoft Authenticator
    - Security Key 또는 기타 하드웨어 기기: OTP 기기, USB 형태의 증명서
- 실습
    
    
    1) IAM 대시보드 → MFA 추가
    
    ![스크린샷 2023-10-26 오전 11.47.27.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.47.27.png)
    
    2) MFA 디바이스 선택 
    
        (Authenticator app)
    
    ![스크린샷 2023-10-26 오전 11.49.17.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.49.17.png)
    
    3) QR코드 및 MFA 과정 완료 후
    
    재로그인시 보여지는 화면
    
    ![스크린샷 2023-10-26 오전 11.54.01.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.54.01.png)
    

### 8. IAM 비밀번호 정책

- IAM 사용자의 암호에 대한 정책 변경 관리
    
    
    ![스크린샷 2023-10-26 오후 12.00.25.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.00.25.png)
    
    - 최소 암호 길이
    - 문자 유형의 조합 개수
    - 암호 만료 설정
    - 암호 재사용 허용/불가 여부
    
    1) IAM 대시보드 > 좌측 계정설정
    
    > 암호 설정 편집
    
    ![스크린샷 2023-10-26 오후 12.02.07.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.02.07.png)
    
    2) 암호 정책 편집
    
    ![스크린샷 2023-10-26 오후 12.02.59.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.02.59.png)
    
    3) 편집 완료 후 화면
    
    ![스크린샷 2023-10-26 오후 12.03.19.png](ch2%20AWS%20IAM%20%E1%84%89%E1%85%A5%E1%84%87%E1%85%B5%E1%84%89%E1%85%B3%2048aa327cdd28445e9675f62299b2ba95/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-10-26_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.03.19.png)
    

### 9. IAM 모범 사례

- 루트 사용자 직접 사용X 적절한 권한 부여된 IAM 사용자를 생성 → AWS 리소스 관리
- 개인 별로 1개의 IAM 사용자 할당
- ID/PW/Access Key 공유X
- IAM 사용자별로 권한 할당X / 그룹에 권한 할당 - IAM사용자를 그룹에 소속시켜 관리
- 모든 사용자가 MFA 사용 및 강력한 비밀번호 정책 적용
- 최소 권한 원칙 적용: “특정 시점”에 필요한 “최소한의 권한만” 부여 - 권한 사용 만료시 반드시 회수