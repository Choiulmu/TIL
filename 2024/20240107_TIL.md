# 20240107 TIL

## ****ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë° - ê¸°ë³¸í¸****

### JPQL BASE

- select m from **Member** as m where **m.age** > 18
- ì—”í‹°í‹°ì™€ ì†ì„±: ëŒ€ì†Œë¬¸ì êµ¬ë¶„O (Member, age)
- JPQL í‚¤ì›Œë“œ: ëŒ€ì†Œë¬¸ì êµ¬ë¶„X (SELECT, FROM, where)
- ì—”í‹°í‹° ì´ë¦„ ì‚¬ìš©, í…Œì´ë¸” ì´ë¦„ì´ ì•„ë‹˜(Member) â†’ B. JPQLì€ ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ê°ì²´ ì§€í–¥ ì¿¼ë¦¬
- **ë³„ì¹­ì€ í•„ìˆ˜(m)** (asëŠ” ìƒëµê°€ëŠ¥) -â­ï¸

### ë°˜í™˜íƒ€ì… ëª…í™• or not

- TypeQuery: ë°˜í™˜ íƒ€ì…ì´ ëª…í™•í•  ë•Œ ì‚¬ìš©
    - TypedQuery<ë¦¬í„´íƒ€ì…> query = em.createQuery("ì¿¼ë¦¬ë¬¸", ë¦¬í„´ íƒ€ì…);
        
        ```java
        TypeQuery<Member> = em.createQuery("select m from Member m where m.age = 18", Member.class)
                .getSingleResult();
        ```
        
- Query: ë°˜í™˜ íƒ€ì…ì´ ëª…í™•í•˜ì§€ ì•Šì„ ë•Œ ì‚¬ìš©
    - Query query = em.createQuery("ì¿¼ë¦¬ë¬¸");

### ê²°ê³¼ì¡°íšŒ API: ê²°ê³¼ê°€ í•˜ë‚˜ or ì—¬ëŸ¬ê°œ

- query.getSingleResult()
    - ê²°ê³¼ í•˜ë‚˜: ë‹¨ì¼ ê°ì²´ ë°˜í™˜
    - ê²°ê³¼ ë‘˜ ì´ìƒ: javax.persistence.NonUniqueResultException
    - ê²°ê³¼ ì—†ìŒ: javax.persistence.NoResultException(â†’ Spring Data JPAì—ì„œ í•¨ìˆ˜/ë°©ë²• ìˆìŒ)
    
    ```java
    Member singleResult = em.createQuery("select m from Member m where m.age = 18", Member.class)
            .getSingleResult();
    ```
    
- query.getResultList()
    - ê²°ê³¼ ìˆìŒ: ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
    - ê²°ê³¼ ì—†ìŒ: ë¹ˆ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜
    - Query íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ
        
        ```java
        List resultList = em.createQuery("select m.username, m.age from Member m")
            .getResultList();
        Object o = resultList.get(0);
        Object[] result = (Object[]) o;
        System.out.println("username = " + result[0]);
        System.out.println("age = " + result[1]);
        ```
        
    - Object[] íƒ€ì…ìœ¼ë¡œ ì¡°íšŒ
        
        ```java
        List<Object[]> resultList = em.createQuery("select m.username, m.age from Member m")
                .getResultList();
        
        Object[] result = resultList.get(0)
        System.out.println("username = " + result[0]);
        System.out.println("age = " + result[1]);
        ```
        
    - new ëª…ë ¹ì–´ë¡œ ì¡°íšŒ
        
        ```java
        List<MemberDto> resultList = em.createQuery("select new com.ulmu.jpqlpractice.MemberDto(m.username, m.age) from Member m", MemberDto.class)
                .getResultList();
        
        MemberDto memberDto = resultList.get(0);
        System.out.println("result Member: " + memberDto.getUsername());
        ```
        
        - íŒ¨í‚¤ì§€ ëª…ì„ í¬í•¨í•œ ì „ì²´ í´ë˜ìŠ¤ ëª… ì…ë ¥
        - ìˆœì„œì™€ íƒ€ì…ì´ ì¼ì¹˜í•˜ëŠ” ìƒì„±ì í•„ìš”
        

### íŒŒë¼ë¯¸í„° ë°”ì¸ë”© - ì ˆëŒ€ ì´ë¦„ ê¸°ì¤€!

```java
TypedQuery<Member> query = em.createQuery("select m from Member m where m.username=:username", Member.class);
query.setParameter("username", "ìµœìœ ë¦¼");
Member singleResult = query.getSingleResult();
```

- usernameì— â€œìµœìœ ë¦¼â€ì„ ë„£ì„ê±°ì•¼~

### í”„ë¡œì ì…˜

- SELECT ì ˆì— ì¡°íšŒí•  ëŒ€ìƒì„ ì§€ì •í•˜ëŠ” ê²ƒ
- ì—”í‹°í‹° / ì„ë² ë””ë“œ íƒ€ì…/ ìŠ¤ì¹¼ë¼(ìˆ«ì/ë¬¸ì ë“± ê¸°ë³¸ë°ì´í„°)ë¥¼ ì¡°íšŒ ê°€ëŠ¥
- ì—”í‹°í‹° í”„ë¡œì ì…˜: SELECT m from Member m / SELECT [m.team](http://m.team) FROM Member m
- ì„ë² ë””íŠ¸ íƒ€ì… í”„ë¡œì ì…˜: SELECT m.address FROM Member m
- ìŠ¤ì¹¼ë¼ íƒ€ì… í”„ë¡œì ì…˜: SELECT m.username, m.age FROM Member m
- DISTINCTë¡œ ì¤‘ë³µ ì œê±°: `SELECT DISTINCT m.username FROM Member m` - ì¤‘ë³µëœ ì´ë¦„ ì œê±°í•˜ê³  ì¤Œ
    
    <aside>
    â˜ğŸ» ì—¬ê¸°ì„œ ì ê¹! ì´ë ‡ê²Œ ì ì–´ì£¼ì„¸ìš”!
    em.createQuery(`SELECT [m.team](http://m.team) FROM Member m`, Member.class)(x)
    em.createQuery(`SELECT t FROM [Member](http://Member.team) m JOIN m.team t`, Team.class) (o)
    
    ì¿¼ë¦¬ëŠ” ì½”ë“œë§Œìœ¼ë¡œ ì˜ˆì¸¡ì´ ê°€ëŠ¥í•´ì•¼í•´ìš”! ì„±ëŠ¥ íŠœë‹/ìµœì í™”í•  ë•Œ SQLì„ ë‹¤ ëŒë¦¬ëŠ” ê²Œ ì•„ë‹ˆë¼, ì½”ë“œë¥¼ ë³´ë©´ì„œ í¬ì¸íŠ¸ë§Œ ìºì¹˜í•´ì„œ ê°œì„ í•´ì•¼í•˜ê¸° ë•Œë¬¸ì´ì£ . ê·¸ëŸ¬ë‹ˆ ì´ë ‡ê²Œ í’€ì–´ì„œ ì ì–´ì£¼ì„¸ìš”:)
    
    </aside>
    

### í˜ì´ì§• API

- setFirstResult(int startPosition): ì¡°íšŒ ì‹œì‘ ìœ„ì¹˜
- setMaxResults(int maxResult): ì¡°íšŒí•  ë°ì´í„° ìˆ˜
- setFirstResult(int startPosition) â†’ startPosition(ìˆ«ì)ë¥¼ indexì²˜ëŸ¼ ìƒê°í•  ê²ƒ(â­ï¸)

```java
for(int i = 0 ; i< 10; i++){
    Member member = new Member();
    member.setUsername("member" + i);
    em.persist(member);
}

em.flush();
em.clear();

List<Member> query = em.createQuery("SELECT m FROM Member m ORDER BY m.username DESC", Member.class)
       .setFirstResult(3)
       .setMaxResults(2)
       .getResultList();

for(Member resultMember : query){
   System.out.println("resultMember: " + resultMember.getUsername());
}

tx.commit();
```

### ìœ í˜•ë³„ ì¡°ì¸ êµ¬í˜„

- INNER JOIN(ë‚´ë¶€ ì¡°ì¸)
    - ë‘ í…Œì´ë¸”ì„ ì¡°ì¸í•  ë•Œ, ë‘ í…Œì´ë¸”ì— ëª¨ë‘ ì§€ì •í•œ ì—´ì˜ ë°ì´í„°ê°€ ìˆì–´ì•¼ í•œë‹¤.
    - `SELECT m FROM Member m [INNER] JOIN m.team t`
    - memberëŠ” ìˆëŠ”ë° teamì€ ì—†ë‹¤ â†’ ë°ì´í„° ì•ˆ ë‚˜ì˜´
- OUTER JOIN(ì™¸ë¶€ ì¡°ì¸)
    - ë‘ í…Œì´ë¸”ì„ ì¡°ì¸í•  ë•Œ, 1ê°œì˜ í…Œì´ë¸”ì—ë§Œ ë°ì´í„°ê°€ ìˆì–´ë„ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.
    - `SELECT m FROM Member m LEFT [OUTER] JOIN m.team t`
    - memberëŠ” ìˆëŠ”ë° teamì€ ì—†ë‹¤ â†’ teamë°ì´í„°ëŠ” nullì´ê³  memberëŠ” ë‹¤ ì¡°íšŒëœë‹¤
- ì„¸íƒ€ ì¡°ì¸(ë§‰ ì¡°ì¸)
    - `select count(m) from Member m, Team t where m.username = [t.name](http://t.name/)`

### ì¡°ì¸ - ONì ˆ

- ì¡°ì¸ ëŒ€ìƒ í•„í„°ë§
    - ì˜ˆì‹œ) íšŒì›ê³¼ íŒ€ì„ ì¡°ì¸í•˜ë©´ì„œ íŒ€ ì´ë¦„ì´ Aì¸ íŒ€ë§Œ ì¡°ì¸
    
    ```java
    String query = "SELECT m FROM Member m inner join m.team t on t.name='TeamA'";
    List<Member> result = em.createQuery(query, Member.class)
            .getResultList();
    ```
    
- ì—°ê´€ê´€ê³„ ì—†ëŠ” ì—”í‹°í‹° ì™¸ë¶€ ì¡°ì¸(hibernate 5.1ë¶€í„°)
    - ì˜ˆì‹œ1) íšŒì›ì˜ ì´ë¦„ê³¼ íŒ€ì˜ ì´ë¦„ì´ ê°™ì€ ëŒ€ìƒ ì™¸ë¶€ ì¡°ì¸
    
    ```java
    String query = "SELECT m FROM Member m inner join m.team t on t.name=m.username";
    List<Member> result = em.createQuery(query, Member.class)
            .getResultList();
    ```
    
    - ì˜ˆì‹œ2) í•œ ê±´ì´ë¼ë„ ì£¼ë¬¸í•œ ê³ ê°

### ì„œë¸Œ ì¿¼ë¦¬ BASE

- ì¿¼ë¦¬ ì†ì˜ ì¿¼ë¦¬
- ì˜ˆì‹œ1) ë‚˜ì´ê°€ í‰ê· ë³´ë‹¤ ë§ì€ íšŒì›
    - select m from Member m where m.age > **(select avg(m2.age) from Member m2)**
    - ì„œë¸Œì¿¼ë¦¬ì— mì„ ë°ë ¤ì˜¨ ê²Œ ì•„ë‹ˆë¼ m2 ìƒˆë¡œ í•¨
    - ë©”ì¸ ì¿¼ë¦¬ì™€ ì„œë¸Œ ì¿¼ë¦¬ê°€ ì„œë¡œ ê´€ê³„ ì—†ìŒ â†’ ì´ë˜ì•¼ ì„œë¸Œ ì¿¼ë¦¬ ì„±ëŠ¥ ì¢‹ìŒ
- ì˜ˆì‹œ2) í•œ ê±´ì´ë¼ë„ ì£¼ë¬¸í•œ ê³ ê°
    - select m from Member m where **(select count(o) from Order o where m = o.member)**>0
    - ë©”ì¸ì¿¼ë¦¬ì˜ mì„ ì„œë¸Œì¿¼ë¦¬ë¡œ ëŒê³ ì˜´ â†’ ì´ëŸ¬ë©´ ë³´í†µ ì„±ëŠ¥ ì•ˆ ì¢‹ìŒ

### ì„œë¸Œ ì¿¼ë¦¬ ì§€ì› í•¨ìˆ˜

- [NOT] EXISTS (subquery): ì„œë¸Œì¿¼ë¦¬ì— ê²°ê³¼ê°€ ì¡´ì¬í•˜ë©´ ì°¸
    - ì˜ˆì‹œ) íŒ€ A ì†Œì†ì¸ íšŒì›
    - select m from Member m where **exists** (select t from m.team t where t.name = â€˜íŒ€A')
- {ALL | ANY | SOME} (subquery)
    - ALL ëª¨ë‘ ë§Œì¡±í•˜ë©´ ì°¸
    - ANY, SOME: ê°™ì€ ì˜ë¯¸, ì¡°ê±´ì„ í•˜ë‚˜ë¼ë„ ë§Œì¡±í•˜ë©´ ì°¸
    - ì˜ˆì‹œ1 ) ì–´ë–¤ íŒ€ì´ë“  íŒ€ì— ì†Œì†ëœ íšŒì›
    - select m from Member m where m.team = **ANY** (select t from Team t)
- [NOT] IN (subquery): ì„œë¸Œì¿¼ë¦¬ì˜ ê²°ê³¼ ì¤‘ í•˜ë‚˜ë¼ë„ ê°™ì€ ê²ƒì´ ìˆìœ¼ë©´ ì°¸

### JPA ì„œë¸Œì¿¼ë¦¬ í•œê³„

- JPAëŠ” WHERE, HAVING ì ˆì—ì„œë§Œ ì„œë¸Œ ì¿¼ë¦¬ ì‚¬ìš© ê°€ëŠ¥(â­ï¸)
- SELECT ì ˆë„ ê°€ëŠ¥(í•˜ì´ë²„ë„¤ì´íŠ¸ì—ì„œ ì§€ì›)
- FROM ì ˆì˜ ì„œë¸Œ ì¿¼ë¦¬ëŠ” í˜„ì¬ JPQLì—ì„œ ë¶ˆê°€ëŠ¥ â†’ ì¡°ì¸ìœ¼ë¡œ í’€ ìˆ˜ ìˆìœ¼ë©´ í’€ì–´ì„œ í•´ê²°
- í•˜ì´ë²„ë„¤ì´íŠ¸6 ë¶€í„°ëŠ” FROM ì ˆì˜ ì„œë¸Œì¿¼ë¦¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

### JPQL íƒ€ì… í‘œí˜„

- ë¬¸ì: â€˜HELLOâ€™, â€˜Sheâ€™â€™sâ€™
- ìˆ«ì: 10L(Long), 10D(Double), 10F(Float)
- Boolean: TRUE, FALSE
- ENUM: jpabook.MemberType.Admin (íŒ¨í‚¤ì§€ëª… í¬í•¨)
- ì—”í‹°í‹° íƒ€ì…: TYPE(m) = Member (ìƒì† ê´€ê³„ì—ì„œ ì‚¬ìš©)

### JPQL íƒ€ì… í‘œí˜„ - ENUM

- ë°©ë²• 1) íŒ¨í‚¤ì§€ëª… í¬í•¨í•´ì„œ ë‹¤ ì“´ë‹¤

```java
String query = "Select m.name, 'HELLO', true from Member m "
                    + "where m.memberType = jpabook.jpashop.domain.MemberType.ADMIN";
List<Object[]> result = em.createQuery(query).getResultList();
```

- ë°©ë²• 2) setParameter í™œìš©

```java
String query = "Select m.name, 'HELLO', true from Member m "
                    + "where m.memberType = :userType";
            List<Object[]> result = em.createQuery(query)
                    .setParameter("userType", MemberType.ADMIN)
                    .getResultList();
```

### JPQL ê¸°íƒ€

- SQLê³¼ ëŒ€ë¶€ë¶„ ë¬¸ë²•ì´ ë¹„ìŠ·í•˜ë‹¤
- EXISTS, IN
- AND, OR, NOT
- =, >, >=, <, <=, <>
- BETWEEN, LIKE, **IS NULL**

### ì¡°ê±´ì‹: CASEì‹

- ê¸°ë³¸ CASEì‹: ìë°”ì˜ switch - caseë¬¸(ë²”ìœ„)

```java
select
	case when m.age <= 10 then 'í•™ìƒìš”ê¸ˆ'
			 when m.age >= 60 then 'ê²½ë¡œìš”ê¸ˆ'
	else 'ì¼ë°˜ìš”ê¸ˆ'
end
from Member m
```

- ë‹¨ìˆœ CASEì‹: ì •í™•íˆ ì´ê±°ë©´ ì´ ê²°ê³¼!

```java
select
	case t.name 
		when 'íŒ€A' then 'ì¸ì„¼í‹°ë¸Œ110%'
		when 'íŒ€B' then 'ì¸ì„¼í‹°ë¸Œ120%'
	else 'ì¸ì„¼í‹°ë¸Œ105%'
end
from Team t
```

### ì¡°ê±´ì‹ í‚¤ì›Œë“œ

- COALESCE: í•˜ë‚˜ì”© ì¡°íšŒí•´ì„œ nullì•„ë‹ˆë©´ ë°˜í™˜

```java
String query = "select coalesce(m.name, 'ì´ë¦„ ì—†ëŠ” íšŒì›') from Member m";
        List<String> resultList = em.createQuery(query, String.class)
                .getResultList();
```

- NULLIF: ë‘ ê°’ì´ ê°™ìœ¼ë©´ null, ë‹¤ë¥´ë©´ ì²«ë²ˆì§¸ ê°’ ë°˜í™˜

```java
String query = "select NULLIF(m.name, 'ê´€ë¦¬ì') from Member m";
		    List<String> resultList = em.createQuery(query, String.class)
		            .getResultList();
```

### JPQL ê¸°ë³¸í•¨ìˆ˜ - ì¶”í›„ ê³µë¶€ ìš”ë§

- CONCAT: ì—¬ëŸ¬ ë¬¸ìì—´/ì»¬ëŸ¼ â†’ í•˜ë‚˜ì˜ ë¬¸ìì—´ë¡œ
- SUBSTRING: ë¬¸ìì—´ì„ ìë¥´ëŠ” í•¨ìˆ˜
- TRIM: ì¢Œìš° ê³µë°±ë§Œ ì œê±°í•˜ëŠ” í•¨ìˆ˜
- LOWER, UPPER: ë¬¸ìë¥¼ ê°ê° ì†Œë¬¸ìë¡œ/ëŒ€ë¬¸ìë¡œ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
- LENGTH: ë¬¸ìì—´ì˜ ê¸¸ì´ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
- LOCATE(substr, str): strì—ì„œ substrì´ ì²˜ìŒ ë‚˜íƒ€ë‚˜ëŠ” ì§€ì  ìœ„ì¹˜ ê°€ì ¸ì˜´
- ABS, SQRT, MOD: xì˜ ì ˆëŒ€ê°’ êµ¬í•˜ëŠ” í•¨ìˆ˜ / xì— ëŒ€í•œ ì œê³±ê·¼ ë°˜í™˜ /MOD(n,m) â†’ nì„ mìœ¼ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ ë°˜í™˜
- SIZE(JPA ìš©ë„): ì»¬ë ‰ì…˜ì˜ í¬ê¸° êµ¬í•˜ëŠ” í•¨ìˆ˜
ì˜ˆì‹œ) select size(t.members) from Teat t â†’ Teamì˜ member ì»¬ë ‰ì…˜ í¬ê¸° ì¡°íšŒ
- INDEX(JPA ìš©ë„): LIST íƒ€ì… ì»¬ë ‰ì…˜ì˜ ìœ„ì¹˜ê°’ì„ êµ¬í•˜ëŠ” í•¨ìˆ˜

[https://velog.io/@jhp1115/JPQL-ê¸°ë³¸í•¨ìˆ˜](https://velog.io/@jhp1115/JPQL-%EA%B8%B0%EB%B3%B8%ED%95%A8%EC%88%98)

### ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ í˜¸ì¶œ

- ëŒ€ë¶€ë¶„ ë°ì´í„°ë² ì´ìŠ¤ í•¨ìˆ˜ë¥¼ JPQLì´ ì¤€ë¹„í•´ë†“ìŒ
- í•˜ì§€ë§Œ ì¼ë¶€ DBì—ì„œ ì‚¬ìš©í•˜ëŠ” íŠ¹ìˆ˜í•œ í•¨ìˆ˜ê°€ ìˆëŠ”ë° ì´ë¥¼ JPAëŠ” ì•Œ ê¸¸ì´ ì—†ë‹¤.
- ê·¸ë˜ì„œ ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ë¥¼ ë“±ë¡/í˜¸ì¶œ/ì‚¬ìš©
- How to?
    
    1) Dialect ë””ë ‰í† ë¦¬ > MyH2Dialect í´ë˜ìŠ¤ ìƒì„±
    
    2) í´ë˜ìŠ¤ ë‚´ ì‚¬ìš©í•˜ë ¤ëŠ” DB ìƒì†/ì‚¬ìš©
    
    ```java
    public class MyH2Dialect extends H2Dialect{
    	public MyH2Dialect(){
          //ë“±ë¡ë°©ë²•ì€ H2Dialect ì°¸ì¡°
    			//2024.01.07ê¸°ì¤€ìœ¼ë¡œëŠ” ì•„ë˜ ë¬¸ë²•ì€ ì•„ë‹Œë“¯
    			registerFunction("group_concat, new StandardSQLFunction("group_concat", StandardBasicTypes.STRING));
    }
    
    ...
    
    ```
    
    3) persistence.xmlì— dialect.MyH2Dialect ì„ ì–¸(ìˆ˜ì •)
    
    4) ì¿¼ë¦¬ì— ì‚¬ìš©: **select function**('group_concat', i.name) **from** Item i
    

- ì¡°ì¸: ì„±ëŠ¥ íŠœë‹ì— ì•„ì£¼ ì§€ëŒ€í•œ ì˜í–¥ì„ ì¤€ë‹¤â€¦
- JPQLì´ë‘ SQLë¹„ìŠ·í•˜ê²Œ ë§ì¶°ì•¼ ì¢‹ì•„..
- ë¬µì‹œì  ë‚´ë¶€ ì¡°ì¸ì´ ì—†ëŠ” ì¿¼ë¦¬ê°€ ì¢‹ì•„â€¦
- Select m.team From Member m(X)
- Select t From Member m Join m.team t
- ë¬µì‹œì  ì¡°ì¸ ì ˆëŒ€ ì“°ì§€ë§ˆâ€¦ ì—†ì• ë²„ë¦¬ê² ì–´..
- select m.username from Team t join t.members m
    - ì»¬ë ‰ì…˜ì„ ë¬µì‹œì  ì¡°ì¸ì´ ì•„ë‹Œ ëª…ì‹œì  ì¡°ì¸ìœ¼ë¡œ í•´ì„œ ê°€ì ¸ì˜¨ ë‹¤ìŒ ë³„ì¹­ m
    - mì—ì„œ ë‹¤ì‹œ ì‹œì‘í•œ ê²ƒì„

## ****ì‹¤ì „! ìŠ¤í”„ë§ ë¶€íŠ¸ì™€ JPA í™œìš©1 - ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ****

### SQL

### Having

**`HAVING`**ê³¼ **`WHERE`**ëŠ” SQLì—ì„œ ë°ì´í„°ë¥¼ í•„í„°ë§í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë‘ ê°€ì§€ ì ˆì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ê·¸ë“¤ ê°„ì— ì¤‘ìš”í•œ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.

1. **ì‚¬ìš©ë˜ëŠ” ìœ„ì¹˜:**
    - **`WHERE`**: **`SELECT`**, **`UPDATE`**, **`DELETE`** ë“±ì˜ ëª…ë ¹ì—ì„œ í–‰ì„ í•„í„°ë§í•©ë‹ˆë‹¤.
    - **`HAVING`**: **`GROUP BY`**ì™€ í•¨ê»˜ ì‚¬ìš©ë˜ì–´ ê·¸ë£¹í™”ëœ ê²°ê³¼ ì§‘í•©ì—ì„œ í–‰ì„ í•„í„°ë§í•©ë‹ˆë‹¤.
2. **ì ìš© ì‹œì :**
    - **`WHERE`**: ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í–‰ì„ ì½ì–´ì˜¤ê¸° ì „ì— ì ìš©ë©ë‹ˆë‹¤.
    - **`HAVING`**: ë°ì´í„°ê°€ ì´ë¯¸ ê·¸ë£¹í™”ëœ í›„ì— ì ìš©ë©ë‹ˆë‹¤.
3. **ì¡°ê±´ ì§€ì •ì˜ ì°¨ì´**
- HAVING: ì§‘ê³„ í•¨ìˆ˜ (ì˜ˆ: COUNT, SUM)ì™€ í•¨ê»˜ ì‚¬ìš©
- WHERE: ë‹¨ì¼ í–‰ ì¡°ê±´ì„ ì§€ì •

```sql
sqlCopy code
-- WHEREë¥¼ ì‚¬ìš©í•œ ì˜ˆì œ //ì£¼ë¬¸ í…Œì´ë¸”ì—ì„œ ì´ ê°€ê²©ì´ 100 ì´ìƒì¸ ì£¼ë¬¸ì„ ì„ íƒ
SELECT * FROM orders WHERE total_price > 100;

-- HAVINGì„ ì‚¬ìš©í•œ ì˜ˆì œ //ì£¼ë¬¸ í…Œì´ë¸”ì—ì„œ ê° ê³ ê°ë³„ë¡œ ì£¼ë¬¸í•œ íšŸìˆ˜ê°€ 2íšŒ ì´ìƒì¸ ê³ ê°ì„ ì„ íƒ
SELECT customer_id, COUNT(order_id) as order_count
FROM orders
GROUP BY customer_id
HAVING order_count > 2;
```

### JOIN

**ë¬¸ì œ 2: íšŒì›ê³¼ ê·¸ íšŒì›ì´ ì£¼ë¬¸í•œ ìƒí’ˆ ì •ë³´ ê°€ì ¸ì˜¤ê¸°**

í…Œì´ë¸”: members, orders, order_items

ì—´

- members: member_id, member_name
- orders: order_id, user_id, order_date
- order_items: order_item_id, order_id, product_id, quantity

í•´ê²°ì±…

```sql
SELECT m.member_id, m.member_name, o.order_id, oi.product_id, oi.quantity
FROM members m
JOIN orders o ON m.member_id = o.user_id
JOIN order_items oi ON o.order_id = oi.order_id;
```